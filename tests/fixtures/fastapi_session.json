{
  "metadata": {
    "package": "fastapi",
    "version": "0.115.0",
    "model": "mock",
    "captured": "2026-02-28",
    "note": "Initial fixture from MockLlmClient responses. Replace with real captured LLM output when rate limits clear."
  },
  "responses": {
    "extract": {
      "prompt_contains": "Extract the complete public API surface",
      "response": "{\n  \"apis\": [\n    {\n      \"name\": \"FastAPI\",\n      \"type\": \"class\",\n      \"signature\": \"FastAPI(debug: bool = False, routes: List[BaseRoute] = None, ...)\",\n      \"return_type\": \"FastAPI\",\n      \"module\": \"fastapi.applications\",\n      \"deprecated\": false\n    },\n    {\n      \"name\": \"APIRouter\",\n      \"type\": \"class\",\n      \"signature\": \"APIRouter(prefix: str = '', tags: List[str] = None, ...)\",\n      \"return_type\": \"APIRouter\",\n      \"module\": \"fastapi.routing\",\n      \"deprecated\": false\n    },\n    {\n      \"name\": \"Request\",\n      \"type\": \"class\",\n      \"module\": \"fastapi\",\n      \"deprecated\": false\n    },\n    {\n      \"name\": \"Response\",\n      \"type\": \"class\",\n      \"module\": \"fastapi\",\n      \"deprecated\": false\n    },\n    {\n      \"name\": \"HTTPException\",\n      \"type\": \"class\",\n      \"signature\": \"HTTPException(status_code: int, detail: Any = None, headers: dict = None)\",\n      \"module\": \"fastapi\",\n      \"deprecated\": false\n    },\n    {\n      \"name\": \"Depends\",\n      \"type\": \"function\",\n      \"signature\": \"Depends(dependency: Callable = None, use_cache: bool = True)\",\n      \"return_type\": \"Any\",\n      \"module\": \"fastapi\",\n      \"deprecated\": false\n    },\n    {\n      \"name\": \"Path\",\n      \"type\": \"function\",\n      \"signature\": \"Path(..., description: str = None, gt: float = None, ...)\",\n      \"module\": \"fastapi\",\n      \"deprecated\": false\n    },\n    {\n      \"name\": \"Query\",\n      \"type\": \"function\",\n      \"signature\": \"Query(default = ..., description: str = None, ...)\",\n      \"module\": \"fastapi\",\n      \"deprecated\": false\n    },\n    {\n      \"name\": \"Body\",\n      \"type\": \"function\",\n      \"signature\": \"Body(default = ..., embed: bool = False, ...)\",\n      \"module\": \"fastapi\",\n      \"deprecated\": false\n    }\n  ]\n}"
    },
    "map": {
      "prompt_contains": "Extract correct usage patterns from the tests",
      "response": "{\n  \"patterns\": [\n    {\n      \"api\": \"FastAPI\",\n      \"pattern\": \"Basic app creation\",\n      \"setup\": \"from fastapi import FastAPI\\napp = FastAPI()\",\n      \"usage\": \"app.get('/')\\ndef root(): return {'message': 'Hello'}\",\n      \"assertion\": \"client.get('/').json() == {'message': 'Hello'}\"\n    },\n    {\n      \"api\": \"Path parameters\",\n      \"pattern\": \"Path parameter with type\",\n      \"setup\": \"@app.get('/items/{item_id}')\",\n      \"usage\": \"def read_item(item_id: int): return {'item_id': item_id}\",\n      \"config\": \"Type hints are validated automatically\"\n    },\n    {\n      \"api\": \"Depends\",\n      \"pattern\": \"Dependency injection\",\n      \"setup\": \"def common_params(q: str = None): return q\",\n      \"usage\": \"@app.get('/items/')\\ndef read(commons = Depends(common_params)): ...\",\n      \"config\": \"Dependencies are cached by default\"\n    },\n    {\n      \"api\": \"Pydantic models\",\n      \"pattern\": \"Request body validation\",\n      \"setup\": \"class Item(BaseModel):\\n    name: str\\n    price: float\",\n      \"usage\": \"@app.post('/items/')\\ndef create(item: Item): return item\",\n      \"config\": \"Automatic JSON parsing and validation\"\n    }\n  ]\n}"
    },
    "learn": {
      "prompt_contains": "Extract conventions, best practices, pitfalls, and migration notes",
      "response": "{\n  \"conventions\": [\n    \"Use async def for endpoints when performing I/O operations\",\n    \"Type hints are required for automatic validation and docs\",\n    \"Path operations are declared with decorators like @app.get()\",\n    \"Pydantic models for request/response schemas\"\n  ],\n  \"pitfalls\": [\n    {\n      \"mistake\": \"Forgetting 'await' with async dependencies\",\n      \"consequence\": \"RuntimeWarning or incorrect behavior\",\n      \"solution\": \"Always await async dependencies\"\n    },\n    {\n      \"mistake\": \"Not using Depends() for shared logic\",\n      \"consequence\": \"Code duplication, harder testing\",\n      \"solution\": \"Extract common code into dependencies\"\n    },\n    {\n      \"mistake\": \"Mutable default arguments in path operations\",\n      \"consequence\": \"Shared state across requests\",\n      \"solution\": \"Use Depends() or None defaults\"\n    }\n  ],\n  \"breaking_changes\": [],\n  \"migration_notes\": []\n}"
    },
    "create": {
      "prompt_contains": "creating an agent rules file",
      "response": "---\nname: fastapi\ndescription: Modern, fast web framework for building APIs with Python\nversion: 0.115.0\necosystem: python\nlicense: MIT\n---\n\n## Imports\n\n```python\nfrom fastapi import FastAPI, APIRouter, Request, Response, HTTPException\nfrom fastapi import Depends, Path, Query, Body, Header, Cookie\nfrom fastapi.responses import JSONResponse, HTMLResponse\nfrom pydantic import BaseModel\n```\n\n## Core Patterns\n\n### 1. Basic Application\n\n```python\nfrom fastapi import FastAPI\n\napp = FastAPI()\n\n@app.get(\"/\")\ndef read_root():\n    return {\"message\": \"Hello World\"}\n```\n\n### 2. Path Parameters\n\n```python\n@app.get(\"/items/{item_id}\")\ndef read_item(item_id: int):\n    return {\"item_id\": item_id}\n```\n\n### 3. Query Parameters\n\n```python\n@app.get(\"/items/\")\ndef read_items(skip: int = 0, limit: int = 10):\n    return {\"skip\": skip, \"limit\": limit}\n```\n\n### 4. Request Body with Pydantic\n\n```python\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    price: float\n    is_offer: bool = False\n\n@app.post(\"/items/\")\ndef create_item(item: Item):\n    return item\n```\n\n### 5. Dependency Injection\n\n```python\nfrom fastapi import Depends\n\ndef common_params(q: str = None, skip: int = 0):\n    return {\"q\": q, \"skip\": skip}\n\n@app.get(\"/items/\")\ndef read_items(commons: dict = Depends(common_params)):\n    return commons\n```\n\n## Configuration\n\n```python\napp = FastAPI(\n    title=\"My API\",\n    description=\"API description\",\n    version=\"1.0.0\",\n    docs_url=\"/docs\",\n    redoc_url=\"/redoc\"\n)\n```\n\n## Pitfalls\n\n### Wrong: Forgetting await with async\n\n```python\n@app.get(\"/users/\")\nasync def get_users(db = Depends(get_db)):\n    users = db.query()  # Missing await!\n    return users\n```\n\n### Right: Use await\n\n```python\n@app.get(\"/users/\")\nasync def get_users(db = Depends(get_db)):\n    users = await db.query()\n    return users\n```\n\n### Wrong: Mutable defaults\n\n```python\n@app.post(\"/items/\")\ndef create(tags: list = []):  # Shared across requests!\n    return tags\n```\n\n### Right: Use None or Depends\n\n```python\n@app.post(\"/items/\")\ndef create(tags: list = None):\n    tags = tags or []\n    return tags\n```\n\n## API Reference\n\n- **FastAPI()** - Main application class\n- **APIRouter()** - Modular route groups\n- **Depends()** - Dependency injection\n- **Path()** - Path parameter with validation\n- **Query()** - Query parameter with validation\n- **Body()** - Request body parameter\n- **HTTPException()** - Raise HTTP errors\n- **Request** - Access raw request\n- **Response** - Custom response\n"
    },
    "create_fix": {
      "prompt_contains": "Here is the current SKILL.md",
      "response": "---\nname: fastapi\ndescription: Modern, fast web framework for building APIs with Python\nversion: 0.115.0\necosystem: python\nlicense: MIT\n---\n\n## Imports\n\n```python\nfrom fastapi import FastAPI, APIRouter, Request, Response, HTTPException\nfrom fastapi import Depends, Path, Query, Body\nfrom pydantic import BaseModel\n```\n\n## Core Patterns\n\n### 1. Basic Application\n\n```python\nfrom fastapi import FastAPI\n\napp = FastAPI()\n\n@app.get(\"/\")\ndef read_root():\n    return {\"message\": \"Hello World\"}\n```\n\n### 2. Path Parameters\n\n```python\n@app.get(\"/items/{item_id}\")\ndef read_item(item_id: int):\n    return {\"item_id\": item_id}\n```\n\n### 3. Dependency Injection\n\n```python\nfrom fastapi import Depends\n\ndef common_params(q: str = None, skip: int = 0):\n    return {\"q\": q, \"skip\": skip}\n\n@app.get(\"/items/\")\ndef read_items(commons: dict = Depends(common_params)):\n    return commons\n```\n\n## Pitfalls\n\n### Wrong: Forgetting await with async\n\n```python\n@app.get(\"/users/\")\nasync def get_users(db = Depends(get_db)):\n    users = db.query()  # Missing await!\n    return users\n```\n\n### Right: Use await\n\n```python\n@app.get(\"/users/\")\nasync def get_users(db = Depends(get_db)):\n    users = await db.query()\n    return users\n```\n"
    },
    "review_introspect": {
      "prompt_contains": "verification script generator",
      "response": "```python\n# /// script\n# requires-python = \">=3.10\"\n# dependencies = [\"fastapi\"]\n# ///\nimport json\nimport importlib.metadata\nimport inspect\n\nresults = {\n    \"version_installed\": \"\",\n    \"version_expected\": \"0.115.0\",\n    \"imports\": [],\n    \"signatures\": [],\n    \"dates\": []\n}\n\n# Check version\ntry:\n    v = importlib.metadata.version(\"fastapi\")\n    results[\"version_installed\"] = v\nexcept Exception as e:\n    results[\"version_installed\"] = f\"ERROR: {e}\"\n\n# Check imports\nfor mod in [\"fastapi\", \"fastapi.routing\"]:\n    try:\n        __import__(mod)\n        results[\"imports\"].append({\"module\": mod, \"ok\": True})\n    except ImportError as e:\n        results[\"imports\"].append({\"module\": mod, \"ok\": False, \"error\": str(e)})\n\n# Check signatures\ntry:\n    from fastapi import FastAPI\n    sig = str(inspect.signature(FastAPI.__init__))\n    results[\"signatures\"].append({\"name\": \"FastAPI.__init__\", \"signature\": sig})\nexcept Exception as e:\n    results[\"signatures\"].append({\"name\": \"FastAPI.__init__\", \"error\": str(e)})\n\nprint(json.dumps(results, indent=2))\n```"
    },
    "review_verdict_pass": {
      "prompt_contains": "quality gate for a generated SKILL.md",
      "response": "{\"passed\": true, \"issues\": []}"
    },
    "review_verdict_fail": {
      "prompt_contains": "quality gate for a generated SKILL.md",
      "response": "{\"passed\": false, \"issues\": [{\"severity\": \"error\", \"category\": \"accuracy\", \"complaint\": \"FastAPI.__init__ signature is incomplete â€” missing 'title', 'description', 'version' parameters\", \"evidence\": \"inspect.signature shows (self, *, debug=False, routes=None, title='FastAPI', description='', version='0.1.0', ...) but SKILL.md shows FastAPI(debug: bool = False, routes: List[BaseRoute] = None, ...)\"}]}"
    }
  }
}
